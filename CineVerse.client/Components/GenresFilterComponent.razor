<div class="genre-table-wrapper" @onclick:stopPropagation>
    <div class="dropdown-toggle" @onclick="ToggleDropdown">
        <span class="label">GENRES</span>
        <span class="value">@LabelText</span>
        <span class="arrow">▾</span>
    </div>

    @if (IsOpen)
    {
        <div class="genre-table-dropdown">
            <div class="genre-table-header">
                <span>Genre</span>
                <div style="display: flex; align-items: center; gap: 5px;">
                    <div style="width: 24px; height: 24px;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 717 621" preserveAspectRatio="xMidYMid meet">
                            <g transform="translate(0,621) scale(0.1,-0.1)" fill="rgba(255, 255, 255, 0.8)" stroke="none">
                                <path d="M2655 5270 c-55 -3 -110 -12 -122 -18 -12 -7 -29 -12 -37 -12 -23 0 -142 -57 -206 -99 -120 -79 -241 -228 -291 -361 -49 -129 -53 -176 -56 -690 -2 -306 0 -491 6 -500 8 -12 44 -16 195 -18 121 -2 192 1 206 8 20 11 20 17 20 458 0 464 6 544 41 616 23 44 106 136 124 136 6 0 16 5 23 12 6 6 38 20 69 30 54 17 125 18 1093 18 l1035 0 68 -26 c98 -38 167 -103 206 -199 l31 -74 0 -1043 c0 -979 -1 -1047 -18 -1093 -45 -126 -114 -195 -237 -238 -19 -7 -213 -13 -520 -16 l-490 -6 -3 -199 c-2 -138 1 -203 9 -212 17 -21 886 -20 1014 1 273 44 471 188 588 429 88 180 82 77 82 1331 0 1249 6 1151 -78 1323 -71 147 -191 279 -309 340 -24 13 -50 27 -58 31 -18 11 -77 33 -150 57 -52 17 -121 18 -1095 20 -572 0 -1085 -2 -1140 -6z" />
                                <path d="M1953 2998 c-4 -7 -10 -197 -13 -423 l-5 -410 -410 -3 c-225 -1 -413 -6 -417 -10 -4 -4 -8 -97 -8 -206 -1 -155 1 -201 12 -207 7 -5 196 -9 421 -9 l407 0 0 -407 c0 -239 4 -414 10 -423 8 -12 43 -16 194 -18 121 -2 192 1 206 8 20 11 20 18 20 413 0 300 3 406 12 415 9 9 113 12 406 12 252 0 400 4 413 10 18 10 19 23 19 203 0 137 -3 196 -12 205 -9 9 -114 12 -409 12 -348 0 -400 2 -413 16 -14 13 -16 65 -16 413 0 295 -3 400 -12 409 -17 17 -394 17 -405 0z" />
                            </g>
                        </svg>
                    </div>
                    <span style="color: white;">include</span>
                </div>

                <div style="display: flex; align-items: center; gap: 5px;">
                    <div style="width: 24px; height: 24px;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 942 843" preserveAspectRatio="xMidYMid meet">
                            <g transform="translate(0,843) scale(0.1,-0.1)" fill="rgba(255, 255, 255, 0.8)" stroke="none">
                                <path d="M2190 7641 c-104 -8 -184 -33 -305 -93 -234 -117 -388 -310 -469
            -589 -14 -50 -16 -213 -16 -1674 0 -1461 2 -1624 16 -1674 93 -319 274 -521
            569 -633 146 -56 117 -53 585 -53 386 0 440 2 480 18 25 9 53 17 62 17 10 0
            34 9 55 19 43 22 83 35 83 27 0 -5 -13 -38 -36 -93 -8 -17 -14 -37 -14 -45 0
            -7 -7 -31 -15 -53 -22 -63 -22 -896 1 -974 93 -319 274 -521 569 -633 151 -58
            -7 -53 1770 -53 l1620 0 65 22 c121 41 148 52 207 84 175 94 305 232 382 404
            13 28 29 63 37 78 8 16 14 36 14 45 0 9 8 37 18 62 16 42 17 151 17 1660 0
            1547 -1 1618 -19 1680 -19 66 -26 87 -66 175 -94 207 -273 369 -505 458 -138
            53 -132 52 -585 52 -405 -1 -429 -2 -503 -22 -43 -12 -83 -26 -90 -30 -15 -10
            -80 -33 -84 -30 -3 4 20 69 30 84 4 7 18 47 30 90 21 75 21 97 22 503 0 385
            -2 431 -19 490 -10 36 -24 79 -32 95 -48 110 -62 137 -101 198 -92 145 -253
            269 -438 340 -148 56 -6 52 -1700 53 -852 1 -1588 -2 -1635 -5z m3160 -615
            c94 -50 144 -112 167 -206 16 -70 18 -624 2 -702 -20 -95 -72 -165 -159 -210
            l-45 -23 -705 -6 c-756 -6 -716 -3 -855 -56 -290 -111 -478 -320 -569 -634
            -14 -49 -16 -137 -16 -710 0 -706 -3 -747 -53 -826 -32 -49 -61 -75 -117 -105
            -45 -23 -46 -23 -425 -23 l-380 0 -49 25 c-52 27 -104 80 -133 139 -17 34 -18
            109 -18 1596 l0 1560 29 53 c36 64 91 110 160 134 48 16 140 17 1591 15 1482
            -2 1541 -3 1575 -21z m243 -1692 c0 -10 -9 -39 -18 -64 -43 -115 -45 -147 -45
            -817 0 -436 -4 -659 -11 -695 -20 -95 -73 -165 -159 -210 l-45 -23 -685 -6
            c-730 -6 -727 -6 -875 -58 -32 -11 -62 -18 -67 -13 -4 4 4 39 18 77 14 39 30
            93 36 120 6 29 13 335 17 740 l6 690 29 53 c35 62 87 107 156 133 47 18 86 19
            654 19 338 0 648 4 703 10 97 10 213 37 250 59 24 14 38 8 36 -15z m1533 -81
            c61 -33 99 -68 131 -121 l28 -47 0 -1570 0 -1570 -27 -45 c-34 -57 -71 -92
            -128 -122 l-45 -23 -1560 0 -1560 0 -49 25 c-52 27 -104 80 -133 139 -16 32
            -18 72 -21 404 l-3 369 24 51 c42 90 109 146 197 165 39 9 251 13 725 15 620
            2 674 4 730 21 286 89 489 256 594 491 13 28 29 63 37 78 8 16 14 36 14 45 0
            9 8 37 17 62 15 40 17 117 20 725 2 438 7 694 14 720 14 53 70 134 113 164 75
            50 86 51 476 48 355 -2 366 -3 406 -24z" />
                            </g>
                        </svg>
                    </div>
                    <span style="color: white;">Exclude</span>
                </div>
            </div>



            @foreach (var genre in Genres)
            {
                <div class="genre-table-row">
                    <span class="genre-name">@genre.Name</span>
                    <input class="genre-filtre-item-checkbox" 
                           type="checkbox"
                           checked="@IncludedGenres.Contains(genre.Id)"
                           @onchange="() => ToggleGenre(genre.Id, true)" />

                    <input class="genre-filtre-item-checkbox"
                           type="checkbox"
                           checked="@ExcludedGenres.Contains(genre.Id)"
                           @onchange="() => ToggleGenre(genre.Id, false)" />
                </div>
            }
        </div>
    }
</div>

<style>
    .genre-filtre-item-checkbox {
        margin-left: 35px;
    }

    .icon-inline {
        display: flex;
        align-items: center;
        gap: 10px;
    }

        .icon-inline svg {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
        }

    .genre-table-wrapper {
        position: relative;
        display: inline-block;
        font-family: sans-serif;
    }

    .dropdown-toggle {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        background: rgba(255,255,255,0.06);
        border-radius: 32px;
        padding: 0.5rem 1rem;
        cursor: pointer;
        color: #fff;
    }

    .label {
        font-weight: 600;
        font-size: 0.95rem;
    }

    .value {
        font-size: 0.9rem;
        background: #444;
        padding: 0 8px;
        border-radius: 6px;
    }

    .arrow {
        font-size: 0.9rem;
        opacity: 0.6;
    }

    .genre-table-dropdown {
        position: absolute;
        top: 100%;
        margin-top: 8px;
        background: #1a1d2b;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.4);
        padding: 1rem;
        z-index: 20;
        width: 350px;
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
        max-height: 340px;
        overflow-y: auto;
    }

    .genre-table-header,
    .genre-table-row {
        display: grid;
        grid-template-columns: 1fr 80px 80px;
        align-items: center;
        gap: 1rem;
    }

    .genre-table-header {
        font-size: 0.85rem;
        font-weight: 600;
        color: #aaa;
        border-bottom: 1px solid rgba(255,255,255,0.1);
        padding-bottom: 0.5rem;
    }

        .genre-table-header .lucide-icon {
            width: 18px;
            height: 18px;
            margin-right: 6px;
            stroke: #5f8fff;
            vertical-align: middle;
        }



    .genre-table-row {
        font-size: 0.9rem;
        color: #eee;
    }

    .genre-name {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .genre-table-row input[type="checkbox"] {
        accent-color: #5f8fff;
        width: 18px;
        height: 18px;
        cursor: pointer;
    }

</style>