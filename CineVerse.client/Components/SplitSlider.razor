@using CineVerse.client.Models

<div class="upcoming-slider" @onmouseenter="Pause" @onmouseleave="Resume">
	<div class="slider-list">
		@foreach (var movie in Movies.Take(MaxVisible))
		{
			<div class="slider-list-item @(movie == Selected ? "active" : "")"
			@onclick="() => Select(movie)">
				<img src="@PosterUrl(movie.PosterPath)" />
				<div class="date">
					<div class="day">@GetDate(movie.ReleaseDate).ToString("MMM dd")</div>
					<div class="year">@GetDate(movie.ReleaseDate).Year</div>
				</div>
			</div>
		}
	</div>

	<div class="slider-preview" @onclick="NavigateToDetails">
		@if (Selected is not null)
		{
			<div class="preview-img" style="background-image:url('@BackdropUrl(Selected.BackdropPath)')"></div>

			<div class="preview-bottom">
				<img class="poster-preview" src="@PosterUrl(Selected.PosterPath, "w342")" />

				<div class="preview-overlay">
					<h2>@Selected.Title</h2>
					@{
						if (AppState.Genres.Any() && Selected.GenreIds.Any())
						{
							var genreNames = Selected.GenreIds
								.Select(id => AppState.Genres.FirstOrDefault(g => g.Id == id)?.Name)
								.Where(name => !string.IsNullOrWhiteSpace(name))
								.ToList();
							<GenreTags Genres="genreNames" Width="600px" />
						} else
						{
							<MudProgressCircular Size="Size.Large" Class="m-6" />
						}
					}
				</div>
			</div>
		}
	</div>
</div>

<style>
	.upcoming-slider {
		display: flex;
		background: var(--clr-surface);
		border-radius: 16px;
		overflow: hidden;
		box-shadow: 0 6px 20px rgba(0,0,0,.3);
	}

	.slider-list {
		width: 300px;
		background: rgba(19, 22, 34, 0.29);
		display: flex;
		flex-direction: column;
		gap: 0.5rem;
		padding: 1rem;
		overflow-y: auto;
	}

	.slider-list-item {
		display: flex;
		gap: 0.75rem;
		align-items: center;
		cursor: pointer;
		border-radius: 10px;
		padding: 0.5rem;
		transition: background .3s;
	}

		.slider-list-item:hover,
		.slider-list-item.active {
			background: rgba(255,255,255,0.05);
		}

		.slider-list-item img {
			width: 45px;
			height: 65px;
			border-radius: 6px;
			object-fit: cover;
		}

		.slider-list-item .date .day {
			color: #fff;
			font-weight: 600;
			font-size: 0.9rem;
		}

		.slider-list-item .date .year {
			color: #aaa;
			font-size: 0.75rem;
		}

	.slider-preview {
		flex: 1;
		position: relative;
		background: #0e0e16;
		cursor: pointer;
	}

	.preview-img {
		position: absolute;
		inset: 0;
		background-size: cover;
		background-position: center;
		filter: brightness(0.65);
		z-index: 1;
	}

		.preview-img::after {
			content: "";
			position: absolute;
			inset: 0;
			background: linear-gradient(to top, rgba(0,0,0,0.6) 30%, transparent 80%);
			z-index: 2;
		}


	.preview-overlay {
		position: relative;
		z-index: 2;
		padding: 2rem;
		color: white;
	}

		.preview-overlay h2 {
			font-size: 1.5rem;
			margin-bottom: .5rem;
		}

		.preview-overlay p {
			opacity: .75;
			font-size: .9rem;
		}

		.preview-overlay h2,
		.preview-overlay p {
			text-shadow: 0 1px 4px rgba(0,0,0,0.7);
		}

	.preview-bottom {
		position: absolute;
		bottom: 2rem;
		left: 3rem;
		display: flex;
		align-items: flex-end;
		gap: 1.5rem;
		z-index: 2;
	}

	.preview-overlay {
		color: white;
	}

		.preview-overlay h2 {
			font-size: 3.5rem;
			margin-bottom: .5rem;
		}

		.preview-overlay p {
			opacity: .75;
			font-size: .9rem;
		}

	.poster-preview {
		width: 320px;
		height: auto;
		border-radius: 12px;
		box-shadow: 0 4px 12px rgba(0,0,0,0.4);
		object-fit: cover;
	}

</style>