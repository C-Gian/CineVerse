@page "/movie/{MovieId:int}"
@using CineVerse.client.Components
@using CineVerse.client.ApiResponses;

@if (Movie is null)
{
	<div class="movie-loading">Loading...</div>
}
else
{
	<div class="movie-detail-page">

		<div>
			<div class="detail-header" style="background-image: url('@BackdropUrl(Movie.BackdropPath)')">
				<div class="detail-header-overlay">

					<img class="poster" src="@PosterUrl(Movie.PosterPath)" alt="@Movie.Title" />

					<div class="header-info">
						<h1>@Movie.Title</h1>
						<h4>@Movie.OriginalTitle</h4>

						<div class="meta-line">
							<span class="rating">⭐ @Movie.VoteAverage</span>
							<span>• @Movie.ReleaseDate</span>
							<span>• @Movie.OriginalLanguage.ToUpper()</span>
							<span>• @Movie.VoteCount votes</span>
						</div>

						<GenreTags Genres="@Movie.Genres.Select(x => x.Name).ToList()" Width="100%" />

						@if (!string.IsNullOrWhiteSpace(Movie.Tagline))
						{
							<p class="tagline">“@Movie.Tagline”</p>
						}

						@if (!string.IsNullOrWhiteSpace(Movie.Homepage))
						{
							<a class="homepage-link" href="@Movie.Homepage" target="_blank">Visit Official Site ↗</a>
						}
					</div>
				</div>
			</div>

			<div class="detail-content">
				<h2>Overview</h2>
				<p>@Movie.Overview</p>

				<div class="info-table">
					<div>
						<strong>ID:</strong> @Movie.Id
					</div>
					<div>
						<strong>Adult:</strong> @(Movie.Adult ? "Yes" : "No")
					</div>
					<div>
						<strong>Video:</strong> @(Movie.Video ? "Yes" : "No")
					</div>
					<div>
						<strong>Popularity:</strong> @Movie.Popularity
					</div>
					<div>
						<strong>Status:</strong> @Movie.Status
					</div>
					<div>
						<strong>Runtime:</strong> @(Movie.Runtime?.ToString() + " min")
					</div>
					<div>
						<strong>Revenue:</strong> @($"{Movie.Revenue:n0}")
					</div>
					<div>
						<strong>Budget:</strong> @($"{Movie.Budget:n0}")
					</div>
					@if (!string.IsNullOrWhiteSpace(Movie.ImdbId))
					{
						<div><strong>IMDB:</strong> <a href="https://www.imdb.com/title/@Movie.ImdbId" target="_blank">@Movie.ImdbId</a></div>
					}
				</div>
			</div>
		</div>

		<div style="margin: 20px;">
			<Carousel TItem="MovieResultResponse" Items="MovieRecommendations.Results" VisibleCount="7" AutoplayMs="5000" SectionName="Similar Movies" CardWidth="200" Margin="100" IsLink="false">
				<SlideTemplate Context="movie">
					<div style="width: 200px; height: 100%;">
						<MovieCard Movie="movie" />
					</div>
				</SlideTemplate>
			</Carousel>
		</div>
	</div>
}

<style>
	.movie-detail-page {
		display: flex;
		gap: 100px;
		flex-direction: column;
		color: #ffffff;
		background-color: #0e0e16;
	}

	.detail-header {
		position: relative;
		height: 500px;
		background-size: cover;
		background-position: center;
	}

	.detail-header-overlay {
		position: absolute;
		inset: 0;
		background: rgba(0, 0, 0, 0.5);
		display: flex;
		align-items: center;
		gap: 2rem;
		padding: 2rem 3rem;
	}

	.poster {
		width: 185px;
		border-radius: 12px;
		box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
		flex-shrink: 0;
	}

	.header-info {
		display: flex;
		flex-direction: column;
		justify-content: center;
		gap: 0.75rem;
		max-width: 60%;
	}

		.header-info h1 {
			font-size: 2rem;
			margin: 0;
			font-weight: 700;
		}

		.header-info h4 {
			font-size: 1.1rem;
			color: #aaa;
			margin: 0;
		}

	.meta-line {
		display: flex;
		flex-wrap: wrap;
		gap: 1rem;
		font-size: 0.95rem;
		color: #ccc;
	}

	.rating {
		color: #FFD700;
		font-weight: 600;
	}

	.tagline {
		font-style: italic;
		color: #ccc;
		margin-top: 0.5rem;
	}

	.homepage-link {
		margin-top: 0.5rem;
		font-size: 0.9rem;
		color: #9db4ff;
		text-decoration: underline;
	}

	.detail-content {
		padding: 2rem 3rem;
		background: #1a1d2b;
		border-top: 1px solid rgba(255,255,255,0.05);
		display: flex;
		flex-direction: column;
		gap: 1.5rem;
	}

		.detail-content h2 {
			font-size: 1.4rem;
			margin-bottom: 0.5rem;
		}

		.detail-content p {
			line-height: 1.6;
			font-size: 1rem;
			color: #ddd;
			max-width: 700px;
		}

	.info-table {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
		gap: 1rem;
		font-size: 0.95rem;
		color: #aaa;
	}
</style>
